(this.webpackJsonptwri=this.webpackJsonptwri||[]).push([[1],{115:function(e,t,n){"use strict";var s=n(5),r=n.n(s),o=n(15),i=n(6),a=n(7),c=n(9),l=n(10),u=n(0),p=n.n(u),d=n(2),h=n(26),f=n(4),j=n(13),v=(n(246),n(80)),b=n(1),m=function(e){Object(c.a)(n,e);var t=Object(l.a)(n);function n(e){var s;return Object(i.a)(this,n),(s=t.call(this,e)).reportText="",s.state={showBugReportAlert:!1,showLicense:!1,showClearAlert:!1,showToast:!1,toastMessage:""},s}return Object(a.a)(n,[{key:"ionViewWillEnter",value:function(){}},{key:"render",value:function(){var e=this;return Object(b.jsxs)(d.o,{children:[Object(b.jsx)(d.e,{children:Object(b.jsx)(d.C,{children:Object(b.jsx)(d.z,{className:"uiFont",children:"\u8a2d\u5b9a"})})}),Object(b.jsxs)(d.d,{children:[Object(b.jsxs)(d.l,{children:[Object(b.jsxs)(d.g,{hidden:!this.props.mainVersion,children:[Object(b.jsx)("div",{tabIndex:0}),Object(b.jsx)(d.f,{icon:j.o,slot:"start"}),Object(b.jsxs)(d.k,{className:"ion-text-wrap uiFont",children:["Backend app \u7248\u672c: ",this.props.mainVersion]})]}),Object(b.jsxs)(d.g,{children:[Object(b.jsx)("div",{tabIndex:0}),Object(b.jsx)(d.f,{icon:j.c,slot:"start"}),Object(b.jsx)(d.k,{className:"ion-text-wrap uiFont",children:Object(b.jsx)("a",{href:"https://github.com/MrMYHuang/twri#report",target:"_new",children:"\u555f\u7528 app \u7570\u5e38\u8a18\u9304"})}),Object(b.jsx)(d.B,{slot:"end",checked:this.props.hasAppLog,onIonChange:function(t){var n=t.detail.checked;e.props.hasAppLog!==n&&(n?f.a.enableAppLog():f.a.disableAppLog(),e.props.dispatch({type:"SET_KEY_VAL",key:"hasAppLog",val:n}))}})]}),Object(b.jsxs)(d.g,{hidden:!this.props.settings.hasAppLog,children:[Object(b.jsx)("div",{tabIndex:0}),Object(b.jsx)(d.f,{icon:j.c,slot:"start"}),Object(b.jsx)(d.k,{className:"ion-text-wrap uiFont",children:"\u56de\u5831 app \u7570\u5e38\u8a18\u9304"}),Object(b.jsx)(d.c,{fill:"outline",shape:"round",slot:"end",size:"large",className:"uiFont",onClick:function(t){e.reportText="\u700f\u89bd\u5668\uff1a"+navigator.userAgent+"\n\nApp\u7248\u672c\uff1a"+v.pwaVersion+"\n\nApp\u8a2d\u5b9a\uff1a"+JSON.stringify(e.props.settings)+"\n\nLog\uff1a\n"+f.a.getLog(),e.setState({showBugReportAlert:!0})},children:"\u56de\u5831"}),Object(b.jsx)(d.a,{cssClass:"uiFont",backdropDismiss:!1,isOpen:this.state.showBugReportAlert,header:"\u7570\u5e38\u56de\u5831",subHeader:"\u8f38\u5165\u60a8\u7684 E-mail\uff0c\u4ee5\u5f8c\u7e8c\u806f\u7d61",inputs:[{name:"name0",type:"email",placeholder:"\u4f8b\uff1aabc@example.com"},{name:"name1",type:"textarea",placeholder:"\u8acb\u63cf\u8ff0\u767c\u751f\u6b65\u9a5f"}],buttons:[{text:"\u9001\u51fa",cssClass:"primary uiFont",handler:function(){var t=Object(o.a)(r.a.mark((function t(n){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(n.name0)){t.next=3;break}return e.setState({showBugReportAlert:!1,showToast:!0,toastMessage:"\u932f\u8aa4\uff0cE-mail \u4e0d\u7b26\u683c\u5f0f\uff01"}),t.abrupt("return");case 3:try{f.a.axiosInstance.post(f.a.bugReportApiUrl,{subject:"".concat(v.productName,"\u7570\u5e38\u8a18\u9304\u56de\u5831"),text:"E-mail: ".concat(n.name0,"\n\n\u767c\u751f\u6b65\u9a5f: ").concat(n.name1,"\n\n").concat(e.reportText)}),e.setState({showBugReportAlert:!1,showToast:!0,toastMessage:"\u7570\u5e38\u56de\u5831\u6210\u529f"})}catch(s){console.error(s),e.setState({showBugReportAlert:!1,showToast:!0,toastMessage:"\u7570\u5e38\u56de\u5831\u5931\u6557"})}case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{text:"\u53d6\u6d88",role:"cancel",cssClass:"secondary uiFont",handler:function(){return e.setState({showBugReportAlert:!1})}}]})]}),Object(b.jsxs)(d.g,{children:[Object(b.jsx)("div",{tabIndex:0}),Object(b.jsx)(d.f,{icon:j.l,slot:"start"}),Object(b.jsx)("div",{className:"contentBlock",children:Object(b.jsxs)("div",{style:{flexDirection:"column"},children:[Object(b.jsx)(d.k,{className:"ion-text-wrap uiFont",children:"App \u8a2d\u5b9a"}),Object(b.jsxs)("div",{style:{textAlign:"right"},children:[Object(b.jsx)(d.c,{fill:"outline",shape:"round",size:"large",style:{fontSize:"var(--ui-font-size)"},onClick:function(){var e=Object(o.a)(r.a.mark((function e(t){var n,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="data:text/json;charset=utf-8,".concat(encodeURIComponent(localStorage.getItem(f.a.storeFile)||"")),(s=document.createElement("a")).href=n,s.download=f.a.storeFile,s.click(),s.remove();case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),children:"\u532f\u51fa"}),Object(b.jsx)("input",{id:"importJsonInput",type:"file",accept:".json",style:{display:"none"},onChange:function(){var t=Object(o.a)(r.a.mark((function t(n){var s,o,i;return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=null===(s=n.target.files)||void 0===s?void 0:s.item(0),t.next=3,null===o||void 0===o?void 0:o.text();case 3:if(t.t0=t.sent,t.t0){t.next=6;break}t.t0="";case 6:i=t.t0;try{JSON.parse(i),localStorage.setItem(f.a.storeFile,i),e.props.dispatch({type:"LOAD_SETTINGS"})}catch(r){console.error(r),console.error((new Error).stack)}document.getElementById("importJsonInput").value="";case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}),Object(b.jsx)(d.c,{fill:"outline",shape:"round",size:"large",style:{fontSize:"var(--ui-font-size)"},onClick:function(e){document.querySelector("#importJsonInput").click()},children:"\u532f\u5165"}),Object(b.jsx)(d.c,{fill:"outline",shape:"round",size:"large",style:{fontSize:"var(--ui-font-size)"},onClick:function(t){e.setState({showClearAlert:!0})},children:"\u91cd\u7f6e"}),Object(b.jsx)(d.a,{cssClass:"uiFont",isOpen:this.state.showClearAlert,backdropDismiss:!1,onDidPresent:function(e){},header:"\u91cd\u7f6e\u6703\u9084\u539f app \u8a2d\u5b9a\u9810\u8a2d\u503c\u4e26\u6e05\u9664\u66f8\u7c64\uff01\u78ba\u5b9a\u91cd\u7f6e\uff1f",buttons:[{text:"\u53d6\u6d88",cssClass:"primary uiFont",handler:function(t){e.setState({showClearAlert:!1})}},{text:"\u91cd\u7f6e",cssClass:"secondary uiFont",handler:function(){var t=Object(o.a)(r.a.mark((function t(n){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.a.clearAppData();case 2:e.props.dispatch({type:"DEFAULT_SETTINGS"}),e.setState({showClearAlert:!1,showToast:!0,toastMessage:"\u6e05\u9664\u6210\u529f!"});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]})]})]})})]}),Object(b.jsxs)(d.g,{children:[Object(b.jsx)("div",{tabIndex:0}),Object(b.jsx)(d.f,{icon:j.k,slot:"start"}),Object(b.jsx)(d.k,{className:"ion-text-wrap uiFont",children:f.a.appSettings.iconSize}),Object(b.jsxs)(d.u,{slot:"end",value:+this.props.settings.iconSize,style:{fontSize:"var(--ui-font-size)"},interface:"popover",interfaceOptions:{cssClass:"twrithemes"},onIonChange:function(t){var n=+t.detail.value;+e.props.settings.iconSize!==n&&e.props.dispatch({type:"SET_KEY_VAL",key:"iconSize",val:n})},children:[Object(b.jsx)(d.v,{className:"uiFont",value:125,children:"\u5c0f"}),Object(b.jsx)(d.v,{className:"uiFont",value:250,children:"\u4e2d"}),Object(b.jsx)(d.v,{className:"uiFont",value:500,children:"\u5927"})]})]}),Object(b.jsxs)(d.g,{children:[Object(b.jsx)("div",{tabIndex:0}),Object(b.jsx)(d.f,{icon:j.k,slot:"start"}),Object(b.jsx)(d.k,{className:"ion-text-wrap uiFont",children:f.a.appSettings.theme}),Object(b.jsxs)(d.u,{slot:"end",value:+this.props.theme,style:{fontSize:"var(--ui-font-size)"},interface:"popover",interfaceOptions:{cssClass:"twrithemes"},onIonChange:function(t){var n=+t.detail.value;+e.props.theme!==n&&e.props.dispatch({type:"SET_KEY_VAL",key:"theme",val:n})},children:[Object(b.jsx)(d.v,{className:"uiFont cbeta",value:0,children:"\u7da0\u5e95"}),Object(b.jsx)(d.v,{className:"uiFont dark",value:1,children:"\u6697\u8272"}),Object(b.jsx)(d.v,{className:"uiFont light",value:2,children:"\u4eae\u8272"}),Object(b.jsx)(d.v,{className:"uiFont oldPaper",value:3,children:"\u820a\u66f8"}),Object(b.jsx)(d.v,{className:"uiFont marble",value:4,children:"\u5927\u7406\u77f3"})]})]}),Object(b.jsxs)(d.g,{children:[Object(b.jsx)("div",{tabIndex:0}),Object(b.jsx)(d.f,{icon:j.z,slot:"start"}),Object(b.jsx)("div",{className:"contentBlock",children:Object(b.jsxs)("div",{style:{flexDirection:"column"},children:[Object(b.jsxs)(d.k,{className:"ion-text-wrap uiFont",children:[f.a.appSettings.uiFontSize,": ",this.props.uiFontSize]}),Object(b.jsx)(d.p,{min:12,max:32,pin:!0,snaps:!0,value:this.props.uiFontSize,onIonChange:function(t){e.props.dispatch({type:"SET_KEY_VAL",key:"uiFontSize",val:+t.detail.value}),e.props.settings.uiFontSize=+t.detail.value,f.a.updateCssVars(e.props.settings)}})]})})]}),Object(b.jsxs)(d.g,{children:[Object(b.jsx)("div",{tabIndex:0}),Object(b.jsx)(d.f,{icon:j.z,slot:"start"}),Object(b.jsxs)("div",{className:"contentBlock",children:[Object(b.jsxs)(d.k,{className:"ion-text-wrap uiFont",children:[f.a.appSettings.textFontSize,": ",Object(b.jsx)("span",{className:"textFont",children:this.props.settings.textFontSize})]}),Object(b.jsx)(d.p,{min:12,max:32,pin:!0,snaps:!0,value:this.props.settings.textFontSize,onIonChange:function(t){e.props.dispatch({type:"SET_KEY_VAL",key:"textFontSize",val:+t.detail.value}),e.props.settings.uiFontSize=+t.detail.value,f.a.updateCssVars(e.props.settings)}})]})]}),Object(b.jsxs)(d.g,{children:[Object(b.jsx)("div",{tabIndex:0}),Object(b.jsx)(d.f,{icon:j.m,slot:"start"}),Object(b.jsxs)("div",{style:{fontSize:"var(--ui-font-size)"},children:[Object(b.jsx)("div",{children:"\u95dc\u65bc"}),Object(b.jsx)("div",{children:Object(b.jsx)("a",{href:"https://github.com/MrMYHuang/twri",target:"_new",children:"\u64cd\u4f5c\u8aaa\u660e\u8207\u958b\u653e\u539f\u59cb\u78bc"})}),Object(b.jsx)("div",{children:Object(b.jsx)("a",{href:"/",onClick:function(t){t.preventDefault(),e.setState({showLicense:!0})},children:"\u7b2c\u4e09\u65b9\u7248\u6b0a\u8072\u660e (\u570b\u5bb6\u767c\u5c55\u59d4\u54e1\u6703\u4fe1\u7bb1\uff1aopendata@ndc.gov.tw)"})}),Object(b.jsx)("div",{children:"\u4f5c\u8005: Meng-Yuan Huang"}),Object(b.jsx)("div",{children:Object(b.jsx)("a",{href:"mailto:myh@live.com",target:"_new",children:"myh@live.com"})})]})]})]}),Object(b.jsx)(d.a,{isOpen:this.state.showLicense,cssClass:"uiFontX0_8",backdropDismiss:!1,message:"\u6b64 app \u4f7f\u7528\u300a\u6c34\u5eab\u6bcf\u65e5\u71df\u904b\u72c0\u6cc1\u300b(https://data.gov.tw/dataset/41568)\u3001\u300a\u6c34\u5eab\u6c34\u60c5\u8cc7\u6599\u300b(https://data.gov.tw/dataset/45501)\u3002\u6b64\u958b\u653e\u8cc7\u6599\u4f9d\u653f\u5e9c\u8cc7\u6599\u958b\u653e\u6388\u6b0a\u689d\u6b3e (Open Government Data License) \u9032\u884c\u516c\u773e\u91cb\u51fa\uff0c\u4f7f\u7528\u8005\u65bc\u9075\u5b88\u672c\u689d\u6b3e\u5404\u9805\u898f\u5b9a\u4e4b\u524d\u63d0\u4e0b\uff0c\u5f97\u5229\u7528\u4e4b\u3002\u653f\u5e9c\u8cc7\u6599\u958b\u653e\u6388\u6b0a\u689d\u6b3e\uff1ahttps://data.gov.tw/license",buttons:[{text:"\u95dc\u9589",cssClass:"primary uiFont",handler:function(t){e.setState({showLicense:!1})}},{text:"\u958b\u555f\u6388\u6b0a",cssClass:"secondary uiFont",handler:function(t){e.setState({showLicense:!1}),window.open("https://data.gov.tw/license")}}]}),Object(b.jsx)(d.A,{cssClass:"uiFont",isOpen:this.state.showToast,onDidDismiss:function(){return e.setState({showToast:!1})},message:this.state.toastMessage,duration:2e3})]})]})}}]),n}(p.a.Component),g=Object(d.N)(m);t.a=Object(h.b)((function(e){return{settings:e.settings,hasAppLog:e.settings.hasAppLog,theme:e.settings.theme,uiFontSize:e.settings.uiFontSize,speechRate:e.settings.speechRate,voiceURI:e.settings.voiceURI,mainVersion:e.tmpSettings.mainVersion}}))(g)},116:function(e,t,n){"use strict";var s=n(22),r=n(6),o=n(7),i=n(9),a=n(10),c=n(0),l=n.n(c),u=n(2),p=n(26),d=n(4),h=n(64),f=(n(248),n(13)),j=n(1),v=Object(j.jsx)(j.Fragment,{children:Object(j.jsx)("div",{style:{fontSize:"var(--ui-font-size)",textAlign:"center"},children:Object(j.jsx)("a",{href:"https://github.com/MrMYHuang/twri#web-app",target:"_new",children:"\u7a0b\u5f0f\u5b89\u88dd\u8aaa\u660e"})})}),b=function(e){Object(i.a)(n,e);var t=Object(a.a)(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,e)).clickedBookmark=void 0,s.state={showInfo:!1,showToast:!1,toastMessage:"",addBookmarkAlert:!1},s}return Object(o.a)(n,[{key:"ionViewWillEnter",value:function(){}},{key:"getReservoirInfos",value:function(){var e=this;return(this.props.settings.showAllReservoirs?this.props.tmpSettings.reservoirs:this.props.tmpSettings.reservoirs.filter((function(e){return e.EffectiveCapacity>1e3}))).map((function(t){return Object(j.jsx)(h.a,Object(s.a)({},Object(s.a)({info:t,onIconClick:function(t){e.clickedBookmark=t,e.setState({addBookmarkAlert:!0})}},e.props)),"HomeReservoirLiquidView".concat(t.ReservoirIdentifier))}))}},{key:"render",value:function(){var e=this;return Object(j.jsxs)(u.o,{children:[Object(j.jsx)(u.e,{children:Object(j.jsxs)(u.C,{children:[Object(j.jsx)(u.z,{style:{fontSize:"var(--ui-font-size)"},children:"\u6c34\u5eab"}),Object(j.jsx)(u.c,{fill:"clear",slot:"end",onClick:function(t){e.setState({showInfo:!0})},children:Object(j.jsx)(u.f,{icon:f.n,slot:"icon-only"})}),Object(j.jsx)(u.c,{fill:this.props.settings.showAllReservoirs?"solid":"clear",slot:"end",onClick:function(t){e.props.dispatch({type:"SET_KEY_VAL",key:"showAllReservoirs",val:!e.props.settings.showAllReservoirs})},children:Object(j.jsx)(u.f,{icon:f.d,slot:"icon-only"})}),Object(j.jsx)(u.c,{fill:"clear",slot:"end",onClick:function(t){d.a.fetchData(e.props.dispatch)},children:Object(j.jsx)(u.f,{icon:f.r,slot:"icon-only"})}),Object(j.jsx)(u.c,{fill:"clear",slot:"end",onClick:function(t){e.props.dispatch({type:"TMP_SET_KEY_VAL",key:"shareTextModal",val:{show:!0,text:decodeURIComponent(window.location.href)}})},children:Object(j.jsx)(u.f,{icon:f.x,slot:"icon-only"})})]})}),Object(j.jsxs)(u.d,{children:[this.props.tmpSettings.isLoading?Object(j.jsx)(u.m,{cssClass:"uiFont",isOpen:this.props.tmpSettings.isLoading,message:"\u8f09\u5165\u4e2d..."}):this.props.tmpSettings.fetchError?d.a.fetchErrorContent:Object(j.jsx)("div",{className:"ReservoirList",children:this.getReservoirInfos()}),v,Object(j.jsx)(u.a,{cssClass:"uiFont",isOpen:this.state.showInfo,backdropDismiss:!1,header:"\u6709\u6548\u84c4\u6c34\u91cf\u55ae\u4f4d\uff1a\u842c\u7acb\u65b9\u516c\u5c3a",buttons:[{text:"\u95dc\u9589",cssClass:"primary uiFont",handler:function(t){e.setState({showInfo:!1})}}]}),Object(j.jsx)(u.a,{cssClass:"uiFont",isOpen:this.state.addBookmarkAlert,backdropDismiss:!1,header:"\u78ba\u5b9a\u65b0\u589e\u81f3\u66f8\u7c64\uff1f",buttons:[{text:"\u53d6\u6d88",cssClass:"primary uiFont",handler:function(t){e.setState({addBookmarkAlert:!1})}},{text:"\u78ba\u5b9a",cssClass:"secondary uiFont",handler:function(t){e.props.dispatch({type:"ADD_BOOKMARK",bookmark:e.clickedBookmark}),e.setState({addBookmarkAlert:!1,showToast:!0,toastMessage:"\u65b0\u589e\u66f8\u7c64\u6210\u529f\uff01"})}}]}),Object(j.jsx)(u.A,{cssClass:"uiFont",isOpen:this.state.showToast,onDidDismiss:function(){return e.setState({showToast:!1})},message:this.state.toastMessage,duration:2e3})]})]})}}]),n}(l.a.Component),m=Object(u.N)(b);t.a=Object(p.b)((function(e){return{tmpSettings:e.tmpSettings,settings:e.settings}}))(m)},117:function(e,t,n){"use strict";var s=n(6),r=n(7),o=n(9),i=n(10),a=n(0),c=n.n(a),l=n(2),u=n(26),p=n(4),d=n(118),h=n(1),f=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).state={isAppSettingsExport:Array(Object.keys(p.a.appSettings).length)},r}return Object(r.a)(n,[{key:"updateQrCode",value:function(){var e=this,t=Object.keys(p.a.appSettings).filter((function(t,n){return e.state.isAppSettingsExport[n]})).map((function(t,n){return{key:t,val:e.props.settings[t]}})).map((function(e){return"".concat(e.key,"=").concat(+e.val)})).join(",");t=""!==t?"settings=".concat(t):null;var n=this.props.text,s=/\?/.test(n);t&&(n+=s?"&".concat(t):"?".concat(t)),p.a.copyToClipboard(n);var r=document.getElementById("qrcCanvas");return d.toCanvas(r,n),r}},{key:"render",value:function(){var e=this;return Object(h.jsx)(l.n,{isOpen:this.props.showModal,cssClass:"uiFont",swipeToClose:!0,onWillPresent:function(){for(var t=[],n=0;n<e.state.isAppSettingsExport.length;n++)t.push(!1);e.setState({isAppSettingsExport:t},(function(){e.updateQrCode()}))},onDidDismiss:function(){return e.props.finish()},children:Object(h.jsx)(l.d,{children:Object(h.jsxs)("div",{style:{display:"flex",flexDirection:"column",height:"100%",alignItems:"center"},children:[Object(h.jsx)("div",{children:Object(h.jsx)(l.k,{className:"uiFont",children:"\u6b64\u9801app\u9023\u7d50\u5df2\u8907\u88fd\u81f3\u526a\u8cbc\u7c3f\uff01"})}),Object(h.jsx)("div",{children:Object(h.jsx)(l.k,{className:"uiFont",children:"\u4e5f\u53ef\u4ee5\u4f7f\u7528QR Code\u5206\u4eab:"})}),Object(h.jsx)("div",{style:{flexGrow:1,flexShrink:0,display:"flex",alignItems:"center",margin:10},children:Object(h.jsx)("canvas",{id:"qrcCanvas",width:"500",height:"500",style:{margin:"0px auto"}})}),Object(h.jsxs)("div",{children:[Object(h.jsx)(l.k,{className:"uiFont",children:"\u5305\u62ecapp\u8a2d\u5b9a:"}),Object(h.jsx)(l.l,{children:Object.keys(p.a.appSettings).map((function(t,n){return Object(h.jsxs)(l.g,{children:[Object(h.jsx)(l.k,{className:"ion-text-wrap uiFont",children:p.a.appSettings[t]}),Object(h.jsx)(l.B,{slot:"end",onIonChange:function(t){var s=e.state.isAppSettingsExport;s[n]=t.detail.checked,e.setState({isAppSettingsExport:s},(function(){e.updateQrCode()}))}})]},"appSettingExportItem_".concat(n))}))})]}),Object(h.jsx)("div",{children:Object(h.jsx)(l.c,{fill:"outline",shape:"round",size:"large",onClick:function(){return e.props.finish()},children:"\u95dc\u9589"})})]})})})}}]),n}(c.a.Component);t.a=Object(u.b)((function(e){return{settings:e.settings}}))(f)},119:function(e,t,n){"use strict";(function(e){var s=n(22),r=n(6),o=n(7),i=n(9),a=n(10),c=n(0),l=n.n(c),u=n(2),p=n(26),d=n(13),h=n(4),f=n(64),j=n(1),v=h.a.isStoreApps()?Object(j.jsx)(j.Fragment,{}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("div",{style:{fontSize:"var(--ui-font-size)",textAlign:"center"},children:Object(j.jsx)("a",{href:"https://github.com/MrMYHuang/twdi#web-app",target:"_new",children:"\u7a0b\u5f0f\u5b89\u88dd\u8aaa\u660e"})}),Object(j.jsx)("div",{style:{fontSize:"var(--ui-font-size)",textAlign:"center"},children:Object(j.jsx)("a",{href:"https://github.com/MrMYHuang/twdi#shortcuts",target:"_new",children:"\u7a0b\u5f0f\u6377\u5f91"})})]}),b=function(t){Object(i.a)(c,t);var n=Object(a.a)(c);function c(e){var t;return Object(r.a)(this,c),(t=n.call(this,e)).bookmarkListRef=void 0,t.state={reorder:!1,showToast:!1,toastMessage:""},t.bookmarkListRef=l.a.createRef(),t}return Object(o.a)(c,[{key:"ionViewWillEnter",value:function(){this.hasBookmark||(this.setState({showToast:!0,toastMessage:"\u7121\u66f8\u7c64\uff01\u8acb\u81f3\u6c34\u5eab\u9801\u65b0\u589e\u4efb\u4e00\u6c34\u5eab\u81f3\u66f8\u7c64\u3002"}),this.props.history.push("".concat(h.a.pwaUrl,"/home")))}},{key:"hasBookmark",get:function(){return this.props.bookmarks.length>0}},{key:"delBookmarkHandler",value:function(t){var n=this;this.props.dispatch({type:"DEL_BOOKMARK",ReservoirIdentifier:t}),e((function(){n.hasBookmark||(n.setState({showToast:!0,toastMessage:"\u7121\u66f8\u7c64\uff01\u8acb\u641c\u5c0b\u85e5\u54c1\u4e26\u52a0\u81f3\u66f8\u7c64\u3002"}),n.props.history.push("".concat(h.a.pwaUrl,"/home")))}))}},{key:"reorderBookmarks",value:function(e){var t=e.detail.complete(this.props.bookmarks);this.props.dispatch({type:"UPDATE_BOOKMARKS",bookmarks:t})}},{key:"getBookmarkRows",value:function(){var e=this,t=this.props.bookmarks,n=Array();return t.forEach((function(t,s){var r="".concat(t.ReservoirName);n.push(Object(j.jsxs)(u.j,{children:[Object(j.jsxs)(u.g,{button:!0,children:[Object(j.jsx)("div",{tabIndex:0}),Object(j.jsx)(u.k,{className:"ion-text-wrap uiFont",children:r},"bookmarkItemLabel_"+s),Object(j.jsx)(u.q,{slot:"end"})]},"bookmarkItem_"+s),Object(j.jsx)(u.i,{side:"end",children:Object(j.jsx)(u.h,{style:{fontSize:"var(--ui-font-size)"},color:"danger",onClick:function(n){var s;e.delBookmarkHandler(t.ReservoirIdentifier),null===(s=e.bookmarkListRef.current)||void 0===s||s.closeSlidingItems()},children:"\u522a\u9664"})})]},"bookmarkItemSliding_"+s))})),n}},{key:"getReservoirInfos",value:function(){var e=this;return this.props.settings.bookmarks.map((function(t){return e.props.tmpSettings.reservoirs.find((function(e){return t.ReservoirIdentifier===e.ReservoirIdentifier}))})).filter((function(e){return void 0!==e})).map((function(t){return Object(j.jsx)(f.a,Object(s.a)({},Object(s.a)({info:t,onIconClick:function(e){}},e.props)),"BookmarkReservoirLiquidView".concat(t.ReservoirIdentifier))}))}},{key:"render",value:function(){var e=this,t=this.getBookmarkRows();return Object(j.jsxs)(u.o,{children:[Object(j.jsx)(u.e,{children:Object(j.jsxs)(u.C,{children:[Object(j.jsx)(u.z,{className:"uiFont",children:"\u66f8\u7c64"}),Object(j.jsx)(u.c,{fill:"clear",slot:"end",onClick:function(t){h.a.fetchData(e.props.dispatch)},children:Object(j.jsx)(u.f,{icon:d.r,slot:"icon-only"})}),Object(j.jsx)(u.c,{fill:this.state.reorder?"solid":"clear",slot:"end",onClick:function(t){return e.setState({reorder:!e.state.reorder})},children:Object(j.jsx)(u.f,{icon:d.y,slot:"icon-only"})})]})}),Object(j.jsxs)(u.d,{children:[this.props.tmpSettings.isLoading?Object(j.jsx)(u.m,{cssClass:"uiFont",isOpen:this.props.tmpSettings.isLoading,message:"\u8f09\u5165\u4e2d..."}):this.props.tmpSettings.fetchError?h.a.fetchErrorContent:this.hasBookmark?this.state.reorder?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(u.l,{ref:this.bookmarkListRef,children:Object(j.jsx)(u.r,{disabled:!this.state.reorder,onIonItemReorder:function(t){e.reorderBookmarks(t)},children:t})},"bookmarkList0"),v]}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("div",{className:"ReservoirList",children:this.getReservoirInfos()}),v]}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(u.l,{children:t},"bookmarkList1"),v]}),Object(j.jsx)(u.A,{cssClass:"uiFont",isOpen:this.state.showToast,onDidDismiss:function(){return e.setState({showToast:!1})},message:this.state.toastMessage,duration:2e3})]})]})}}]),c}(l.a.Component),m=Object(u.N)(b);t.a=Object(p.b)((function(e){return{bookmarks:e.settings.bookmarks,settings:e.settings,tmpSettings:e.tmpSettings}}))(m)}).call(this,n(97).setImmediate)},120:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var s=n(46),r=n(45),o=n(22),i=n(4),a=n(6),c=function e(){Object(a.a)(this,e),this.version=1,this.hasAppLog=!0,this.theme=1,this.uiFontSize=24,this.textFontSize=24,this.showAllReservoirs=!1,this.iconSize=250,this.bookmarks=[]};function l(e){for(;document.body.classList.length>0;)document.body.classList.remove(document.body.classList.item(0));document.body.classList.toggle("theme".concat(e.theme),!0),i.a.updateCssVars(e)}var u=Object(s.a)({settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new c,t=arguments.length>1?arguments[1]:void 0,n=Object(o.a)({},e);switch(t.type){case"ADD_BOOKMARK":n.bookmarks=[].concat(Object(r.a)(n.bookmarks),[t.bookmark]),localStorage.setItem(i.a.storeFile,JSON.stringify({settings:n}));break;case"DEL_BOOKMARK":var s=n.bookmarks,a=s.findIndex((function(e){return e.ReservoirIdentifier===t.ReservoirIdentifier}));-1!==a&&s.splice(a,1),n.bookmarks=Object(r.a)(s),localStorage.setItem(i.a.storeFile,JSON.stringify({settings:n}));break;case"LOAD_SETTINGS":l(n=JSON.parse(localStorage.getItem(i.a.storeFile)).settings);break;case"SET_KEY_VAL":var u=t.key,p=t.val;switch(u){case"theme":document.body.classList.forEach((function(e){/theme/.test(e)&&document.body.classList.remove(e)})),document.body.classList.toggle("theme".concat(p),!0)}n[u]=p,localStorage.setItem(i.a.storeFile,JSON.stringify({settings:n}));break;case"DEFAULT_SETTINGS":l(n=new c);break;default:0===Object.keys(n).length&&(n=new c);var d=new c;Object.keys(d).forEach((function(e){void 0===n[e]&&(n[e]=d[e])}))}return n},tmpSettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=Object(o.a)({},e),s=t.key,r=t.val;switch(n[s]=r,t.type){case"TMP_SET_KEY_VAL":return n}return e}});function p(){var e=localStorage.getItem(i.a.storeFile);return null!=e?Object(s.b)(u,JSON.parse(e)):Object(s.b)(u)}},197:function(e,t,n){var s={"./ion-action-sheet.entry.js":[275,5],"./ion-alert.entry.js":[276,6],"./ion-app_8.entry.js":[277,7],"./ion-avatar_3.entry.js":[278,17],"./ion-back-button.entry.js":[279,18],"./ion-backdrop.entry.js":[280,43],"./ion-button_2.entry.js":[281,19],"./ion-card_5.entry.js":[282,20],"./ion-checkbox.entry.js":[283,21],"./ion-chip.entry.js":[284,22],"./ion-col_3.entry.js":[285,44],"./ion-datetime_3.entry.js":[286,10],"./ion-fab_3.entry.js":[287,23],"./ion-img.entry.js":[288,45],"./ion-infinite-scroll_2.entry.js":[289,46],"./ion-input.entry.js":[290,24],"./ion-item-option_3.entry.js":[291,25],"./ion-item_8.entry.js":[292,26],"./ion-loading.entry.js":[293,27],"./ion-menu_3.entry.js":[294,28],"./ion-modal.entry.js":[295,8],"./ion-nav_2.entry.js":[296,14],"./ion-popover.entry.js":[297,9],"./ion-progress-bar.entry.js":[298,29],"./ion-radio_2.entry.js":[299,30],"./ion-range.entry.js":[300,31],"./ion-refresher_2.entry.js":[301,11],"./ion-reorder_2.entry.js":[302,16],"./ion-ripple-effect.entry.js":[303,47],"./ion-route_4.entry.js":[304,32],"./ion-searchbar.entry.js":[305,33],"./ion-segment_2.entry.js":[306,34],"./ion-select_3.entry.js":[307,35],"./ion-slide_2.entry.js":[308,48],"./ion-spinner.entry.js":[309,13],"./ion-split-pane.entry.js":[310,49],"./ion-tab-bar_2.entry.js":[311,36],"./ion-tab_2.entry.js":[312,15],"./ion-text.entry.js":[313,37],"./ion-textarea.entry.js":[314,38],"./ion-toast.entry.js":[315,39],"./ion-toggle.entry.js":[316,12],"./ion-virtual-scroll.entry.js":[317,50]};function r(e){if(!n.o(s,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=s[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(s)},r.id=197,e.exports=r},199:function(e,t,n){var s={"./ion-icon.entry.js":[318,57]};function r(e){if(!n.o(s,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=s[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(s)},r.id=199,e.exports=r},245:function(e,t,n){},246:function(e,t,n){},247:function(e,t,n){},248:function(e,t,n){},273:function(e,t,n){"use strict";n.r(t);n(0);var s=n(31),r=n.n(s),o=n(61),i=n(65),a=n(4),c=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function l(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){console.log("installingWorker stage changed: ".concat(n.state)),"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var u=n(1);a.a.enableAppLog(),r.a.render(Object(u.jsx)(o.a,{children:Object(u.jsx)(i.a,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/twri",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/twri","/service-worker.js");c?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var s=n.headers.get("content-type");404===n.status||null!=s&&-1===s.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):l(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):l(t,e)}))}}({onSuccess:function(e){console.log("Precache app loaded!"),i.b.onSuccess(e)},onUpdate:function(e){console.log("Found app updated!"),i.b.onUpdate(e)}})},4:function(e,t,n){"use strict";var s=n(5),r=n.n(s),o=n(15),i=n(114),a=n.n(i),c=n(2),l=n(1),u="/twri",p="https://d23fxcqevt3np7.cloudfront.net/twrData.json",d=a.a.create({baseURL:p,timeout:8e3});function h(){return(h=Object(o.a)(r.a.mark((function e(t){var n,s,o,i,a,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:"TMP_SET_KEY_VAL",key:"isLoading",val:!0}),e.prev=1,e.next=4,d.get(p,{responseType:"arraybuffer"});case 4:return s=e.sent,n=JSON.parse((new TextDecoder).decode(s.data)),o=n.DailyOperationalStatisticsOfReservoirs_OPENDATA,e.next=9,g.axiosInstance.get(g.twrWaterDataUrl+"?timeStamp=".concat((new Date).getTime()),{responseType:"arraybuffer"});case 9:i=e.sent,n=JSON.parse((new TextDecoder).decode(i.data)),a=n.ReservoirConditionData_OPENDATA,c={},a.forEach((function(e){if(null!=c[e.ReservoirIdentifier]){var t=c[e.ReservoirIdentifier];new Date(t.ObservationTime)<new Date(e.ObservationTime)&&(c[e.ReservoirIdentifier]=e)}else c[e.ReservoirIdentifier]=e})),o.forEach((function(e){null!=c[e.ReservoirIdentifier]&&(e.latestWaterData=c[e.ReservoirIdentifier])})),t({type:"TMP_SET_KEY_VAL",key:"reservoirs",val:o}),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),t({type:"TMP_SET_KEY_VAL",key:"fetchError",val:!0});case 21:t({type:"TMP_SET_KEY_VAL",key:"isLoading",val:!1});case 22:case"end":return e.stop()}}),e,null,[[1,18]])})))).apply(this,arguments)}var f="";function j(){return(j=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.clear();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v=console.log.bind(console),b=console.error.bind(console);function m(){return Object(c.L)("ios")&&"MacIntel"===navigator.platform}var g={pwaUrl:u,bugReportApiUrl:"https://vh6ud1o56g.execute-api.ap-northeast-1.amazonaws.com/bugReportMailer",twrDataUrl:p,twrWaterDataUrl:"https://d23fxcqevt3np7.cloudfront.net/twrDataWater.json",axiosInstance:d,fetchData:function(e){return h.apply(this,arguments)},storeFile:"TwriSettings.json",getLog:function(){return f},enableAppLog:function(){console.log=function(){f+="----- Info ----\n",f+=Array.from(arguments)+"\n",v.apply(console,arguments)},console.error=function(){f+="----- Error ----\n",f+=Array.from(arguments)+"\n",b.apply(console,arguments)}},disableAppLog:function(){f="",console.log=v,console.error=b},appSettings:{iconSize:"\u5716\u793a\u5927\u5c0f",theme:"\u4f48\u666f\u4e3b\u984c",uiFontSize:"UI \u5b57\u578b\u5927\u5c0f",textFontSize:"\u5167\u5bb9\u6587\u5b57\u5927\u5c0f"},fetchErrorContent:Object(l.jsx)("div",{className:"contentCenter",children:Object(l.jsx)(c.k,{children:Object(l.jsxs)("div",{children:[Object(l.jsx)("div",{children:"\u9023\u7dda\u5931\u6557!"}),Object(l.jsxs)("div",{style:{fontSize:"var(--ui-font-size)",paddingTop:24},children:["\u8acb\u5617\u8a66\u9ede\u64ca\u53f3\u4e0a\u65b9\u7684\u91cd\u65b0\u8b80\u53d6\u6309\u9215\u3002\u5982\u679c\u554f\u984c\u6301\u7e8c\u767c\u751f\uff0c\u8acb\u57f7\u884c",Object(l.jsx)("a",{href:"/".concat(u,"/settings"),target:"_self",children:"\u8a2d\u5b9a\u9801"}),"\u7684 app \u7570\u5e38\u56de\u5831\u529f\u80fd\u3002"]})]})})}),updateApp:function(){return new Promise(function(){var e=Object(o.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:navigator.serviceWorker.getRegistrations().then(function(){var e=Object(o.a)(r.a.mark((function e(n){var s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(n.map((function(e){return e.update().then((function(e){return null!==e.installing||null!==e.waiting}))})));case 2:s=e.sent,t(s.reduce((function(e,t){return e||t}),!1));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},updateCssVars:function(e){document.documentElement.style.cssText="--text-font-size: ".concat(e.textFontSize,"px; --ui-font-size: ").concat(e.uiFontSize,"px;")},isMacCatalyst:m,isTouchDevice:function(){return Object(c.L)("ios")&&!m()||Object(c.L)("android")},isStoreApps:function(){return Object(c.L)("pwa")||Object(c.L)("electron")},clearAppData:function(){return j.apply(this,arguments)},disableAndroidChromeCallout:function(e){return e.preventDefault(),e.stopPropagation(),!1},disableIosSafariCallout:function(e){var t=this.getSelection();if(((null===t||void 0===t?void 0:t.rangeCount)||0)>0){var n=null===t||void 0===t?void 0:t.getRangeAt(0);null===t||void 0===t||t.removeAllRanges(),setTimeout((function(){null===t||void 0===t||t.addRange(n)}),50)}},copyToClipboard:function(e){try{navigator.clipboard&&navigator.clipboard.writeText(e)}catch(t){console.error(t)}}};t.a=g},64:function(e,t,n){"use strict";var s=n(6),r=n(7),o=n(9),i=n(10),a=n(0),c=n.n(a),l=n(26),u=n(19);n(247);var p=function e(t){Object(s.a)(this,e),this.ReservoirIdentifier="",this.ReservoirName="",this.ReservoirIdentifier=t.ReservoirIdentifier,this.ReservoirName=t.ReservoirName},d=n(321),h=n(1),f=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).id="id"+Object(d.a)(),r.state={},r}return Object(r.a)(n,[{key:"componentDidMount",value:function(){this.updateLiquidIcon()}},{key:"componentDidUpdate",value:function(){this.updateLiquidIcon()}},{key:"updateLiquidIcon",value:function(){var e,t=((null===(e=this.props.info.latestWaterData)||void 0===e?void 0:e.EffectiveWaterStorageCapacity)||0)/this.props.info.EffectiveCapacity*100,n={minValue:0,maxValue:100,circleThickness:.05,circleFillGap:.05,circleColor:"#178BCA",waveHeight:.05,waveCount:1,waveRiseTime:1e3,waveAnimateTime:18e3,waveRise:!0,waveHeightScaling:!0,waveAnimate:!0,waveColor:"#178BCA",waveOffset:0,textVertPosition:.5,textSize:1,valueCountUp:!0,displayPercent:!0,textColor:"#045681",waveTextColor:"#A4DBf8"};t>=50?this.setEnoughColor(n):this.setShortageColor(n),n.circleThickness=.1,n.textVertPosition=.5,n.waveAnimateTime=1e3,n.waveHeight=.05,n.waveAnimate=!0,n.waveRise=!1,n.waveHeightScaling=!0,n.waveOffset=.25,n.textSize=.75,n.waveCount=3;try{!function(e,t,n){null==n&&(n={minValue:0,maxValue:100,circleThickness:.05,circleFillGap:.05,circleColor:"#178BCA",waveHeight:.05,waveCount:1,waveRiseTime:1e3,waveAnimateTime:18e3,waveRise:!0,waveHeightScaling:!0,waveAnimate:!0,waveColor:"#178BCA",waveOffset:0,textVertPosition:.5,textSize:1,valueCountUp:!0,displayPercent:!0,textColor:"#045681",waveTextColor:"#A4DBf8"});var s=u.f("#"+e);s.selectChildren().remove();var r,o=Math.min(parseInt(s.style("width")),parseInt(s.style("height")))/2,i=parseInt(s.style("width"))/2-o,a=parseInt(s.style("height"))/2-o,c=Math.max(n.minValue,Math.min(n.maxValue,t))/n.maxValue;r=n.waveHeightScaling?u.e().range([0,n.waveHeight,0]).domain([0,50,100]):u.e().range([n.waveHeight,n.waveHeight]).domain([0,100]);var l=n.textSize*o/2,p=parseFloat(t).toFixed(2),d=n.valueCountUp?n.minValue:p,h=n.displayPercent?"%":"",f=n.circleThickness*o,j=f+n.circleFillGap*o,v=o-j,b=v*r(100*c),m=2*v/n.waveCount,g=1+n.waveCount,x=m*g,w=function(e){return Math.round(e)};parseFloat(p)!==parseFloat(w(p))&&(w=function(e){return parseFloat(e).toFixed(1)}),parseFloat(p)!==parseFloat(w(p))&&(w=function(e){return parseFloat(e).toFixed(2)});for(var O=[],k=0;k<=40*g;k++)O.push({x:k/(40*g),y:k/40});var y=u.e().range([0,2*Math.PI]).domain([0,1]),S=u.e().range([0,o]).domain([0,o]),C=u.e().range([0,x]).domain([0,1]),A=u.e().range([0,b]).domain([0,1]),T=u.e().range([j+2*v+b,j-b]).domain([0,1]),F=u.e().range([0,x-2*v]).domain([0,1]),I=u.e().range([j+2*v,j+.7*l]).domain([0,1]),L=s.append("g").attr("transform","translate("+i+","+a+")"),R=u.a().startAngle(y(0)).endAngle(y(1)).outerRadius(S(o)).innerRadius(S(o-f));L.append("path").attr("d",R).style("fill",n.circleColor).attr("transform","translate("+o+","+o+")");var E=L.append("text").text(w(d)+h).attr("class","liquidFillGaugeText").attr("text-anchor","middle").attr("font-size",l+"px").style("fill",n.textColor).attr("transform","translate("+o+","+I(n.textVertPosition)+")"),_=u.b().x((function(e){return C(e.x)})).y0((function(e){return A(Math.sin(2*Math.PI*n.waveOffset*-1+2*Math.PI*(1-n.waveCount)+2*e.y*Math.PI))})).y1((function(e){return 2*v+b})),M=L.append("defs").append("clipPath").attr("id","clipWave"+e),N=M.append("path").datum(O).attr("d",_).attr("T",0),D=L.append("g").attr("clip-path","url(#clipWave"+e+")");D.append("circle").attr("cx",o).attr("cy",o).attr("r",v).style("fill",n.waveColor);var z=D.append("text").text(w(d)+h).attr("class","liquidFillGaugeText").attr("text-anchor","middle").attr("font-size",l+"px").style("fill",n.waveTextColor).attr("transform","translate("+o+","+I(n.textVertPosition)+")");if(n.valueCountUp){var B=function(){var e=u.d(this.textContent,p);return function(t){this.textContent=w(e(t))+h}};E.transition().duration(n.waveRiseTime).tween("text",B),z.transition().duration(n.waveRiseTime).tween("text",B)}var U=j+2*v-x;function V(){N.attr("transform","translate("+F(N.attr("T"))+",0)"),N.transition().duration(n.waveAnimateTime*(1-N.attr("T"))).ease(u.c).attr("transform","translate("+F(1)+",0)").attr("T",1).on("end",(function(){N.attr("T",0),V(n.waveAnimateTime)}))}n.waveRise?M.attr("transform","translate("+U+","+T(0)+")").transition().duration(n.waveRiseTime).attr("transform","translate("+U+","+T(c)+")").on("start",(function(){N.attr("transform","translate(1,0)")})):M.attr("transform","translate("+U+","+T(c)+")"),n.waveAnimate&&V(),new function(){this.update=function(e){var t=parseFloat(e).toFixed(2),s=function(e){return Math.round(e)};parseFloat(t)!==parseFloat(s(t))&&(s=function(e){return parseFloat(e).toFixed(1)}),parseFloat(t)!==parseFloat(s(t))&&(s=function(e){return parseFloat(e).toFixed(2)});var o=function(){var t=u.d(this.textContent,parseFloat(e).toFixed(2));return function(e){this.textContent=s(t(e))+h}};E.transition().duration(n.waveRiseTime).tween("text",o),z.transition().duration(n.waveRiseTime).tween("text",o);var i,a=Math.max(n.minValue,Math.min(n.maxValue,e))/n.maxValue,c=v*r(100*a),l=u.e().range([j+2*v+c,j-c]).domain([0,1])(a),p=u.e().range([0,x]).domain([0,1]),d=u.e().range([0,c]).domain([0,1]);i=n.waveHeightScaling?u.b().x((function(e){return p(e.x)})).y0((function(e){return d(Math.sin(2*Math.PI*n.waveOffset*-1+2*Math.PI*(1-n.waveCount)+2*e.y*Math.PI))})).y1((function(e){return 2*v+c})):_;var f=n.waveAnimate?F(1):0;N.transition().duration(0).transition().duration(n.waveAnimate?n.waveAnimateTime*(1-N.attr("T")):n.waveRiseTime).ease(u.c).attr("d",i).attr("transform","translate("+f+",0)").attr("T","1").on("end",(function(){n.waveAnimate&&(N.attr("transform","translate("+F(0)+",0)"),V(n.waveAnimateTime))})),M.transition().duration(n.waveRiseTime).attr("transform","translate("+U+","+l+")")}}}(this.id,t.toFixed(1),n)}catch(s){console.error(s)}}},{key:"setEnoughColor",value:function(e){e.circleColor="#0080ff",e.textColor="#0080ff",e.waveTextColor="#ffffff",e.waveColor="#0080ff"}},{key:"setShortageColor",value:function(e){e.circleColor="#ff0080",e.textColor="#ff0080",e.waveTextColor="#ffffff",e.waveColor="#ff0080"}},{key:"getTime",value:function(){var e,t,n=new Date(null!==(e=null===(t=this.props.info.latestWaterData)||void 0===t?void 0:t.ObservationTime)&&void 0!==e?e:0);return"".concat(n.toLocaleDateString(),", ").concat(n.getHours()," ").concat(n.getHours()>=12?"PM":"AM")}},{key:"render",value:function(){var e,t=this;return Object(h.jsxs)("div",{className:"Reservoir",children:[Object(h.jsx)("div",{className:"textFont title",children:this.props.info.ReservoirName}),Object(h.jsx)("div",{className:"title",children:Object(h.jsx)("svg",{id:this.id,width:"".concat(this.props.settings.iconSize,"px"),height:"".concat(this.props.settings.iconSize,"px"),onClick:function(e){t.props.onIconClick(new p({ReservoirIdentifier:t.props.info.ReservoirIdentifier,ReservoirName:t.props.info.ReservoirName}))}})}),Object(h.jsxs)("div",{style:{width:"".concat(this.props.settings.iconSize,"px")},children:[Object(h.jsxs)("div",{className:"textFontX0_8",children:["\u6709\u6548\u84c4\u6c34\u91cf\uff1a",Math.round((null===(e=this.props.info.latestWaterData)||void 0===e?void 0:e.EffectiveWaterStorageCapacity)||0)]}),Object(h.jsxs)("div",{className:"textFontX0_8",hidden:!this.props.settings.showAllReservoirs,children:["\u6709\u6548\u5bb9\u91cf\uff1a",Math.round(this.props.info.EffectiveCapacity||0)]}),Object(h.jsxs)("div",{className:"textFontX0_8",children:["\u89c0\u6e2c\u6642\u9593\uff1a",this.getTime()]})]})]})}}]),n}(c.a.Component);t.a=Object(l.b)((function(e){return{settings:e.settings}}))(f)},65:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return F}));var s=n(5),r=n.n(s),o=n(15),i=n(22),a=n(6),c=n(7),l=n(9),u=n(10),p=n(0),d=n.n(p),h=n(12),f=n(2),j=n(112),v=n(26),b=n(113),m=n.n(b),g=n(120),x=n(13),w=(n(235),n(236),n(237),n(238),n(239),n(240),n(241),n(242),n(243),n(244),n(245),n(115)),O=n(116),k=n(4),y=n(117),S=n(119),C=n(1),A=window.electronBackendApi,T=Object(g.a)();Object(f.M)({mode:"md",swipeBackEnabled:!1});var F={onSuccess:function(e){},onUpdate:function(e){}},I=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return Object(C.jsx)(v.a,{store:T,children:Object(C.jsx)(R,Object(i.a)({},this.props))})}}]),n}(d.a.Component),L=function(t){Object(l.a)(s,t);var n=Object(u.a)(s);function s(t){var i;for(Object(a.a)(this,s),k.a.fetchData(T.dispatch),(i=n.call(this,t)).registrationNew=void 0,i.originalAppSettingsStr=void 0,i.wakeLock=void 0,i.props.settings.hasAppLog||k.a.disableAppLog(),null===A||void 0===A||A.receive("fromMain",(function(e){switch(e.event){case"version":T.dispatch({type:"TMP_SET_KEY_VAL",key:"mainVersion",val:e.version})}})),null===A||void 0===A||A.send("toMain",{event:"ready"}),i.registrationNew=null,Object(f.L)("android")?window.oncontextmenu=k.a.disableAndroidChromeCallout:Object(f.L)("ios")&&(document.ontouchend=k.a.disableIosSafariCallout.bind(window));document.body.classList.length>0;)document.body.classList.remove(document.body.classList.item(0));document.body.classList.toggle("theme".concat(i.props.settings.theme),!0);var c=m.a.parse(i.props.location.search);return c.settings&&(i.originalAppSettingsStr=localStorage.getItem(k.a.storeFile),c.settings.split(",").forEach((function(e){var t=e.split("=");i.props.dispatch({type:"SET_KEY_VAL",key:t[0],val:+t[1]})}))),e((function(){k.a.updateCssVars(i.props.settings)})),i.state={showUpdateAlert:!1,showRestoreAppSettingsToast:null!=c.settings&&null!=i.originalAppSettingsStr||!1,showToast:!1,toastMessage:"",downloadModal:{progress:0,show:!1}},F.onUpdate=function(e){i.registrationNew=e,i.setState({showUpdateAlert:!0})},F.onSuccess=function(e){},"undefined"!==typeof speechSynthesis&&(speechSynthesis.getVoices(),speechSynthesis.cancel()),navigator.wakeLock&&(i.wakeLockScreen(),document.addEventListener("visibilitychange",Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"visible"===document.visibilityState?i.wakeLockScreen():i.wakeLockScreenRelease();case 1:case"end":return e.stop()}}),e)}))))),i}return Object(c.a)(s,[{key:"restoreAppSettings",value:function(){localStorage.setItem(k.a.storeFile,this.originalAppSettingsStr),this.props.dispatch({type:"LOAD_SETTINGS"})}},{key:"wakeLockScreen",value:function(){var e=Object(o.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,null==(t=navigator.wakeLock)){e.next=9;break}return e.next=5,t.request("screen");case 5:this.wakeLock=e.sent,console.log("Screen wake lock is requested."),e.next=10;break;case 9:console.error("navigator.wakeLock is undefined.");case 10:e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.log("".concat(e.t0.name,", ").concat(e.t0.message)),console.log((new Error).stack);case 16:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"wakeLockScreenRelease",value:function(){var e=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.wakeLock){e.next=5;break}return e.next=3,this.wakeLock.release();case 3:this.wakeLock=null,console.log("Screen wake lock is released.");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"routeByQueryString",value:function(){console.log(window.location.search);var e=/route=([^&]*)/.exec(window.location.search),t=/query=([^&]*)/.exec(window.location.search);if(null!==e){var n=decodeURIComponent(e[1]),s="";return null!==t&&(s=decodeURIComponent(t[1])),Object(C.jsx)(h.a,{to:"".concat(k.a.pwaUrl)+n+s})}if(window.location.pathname==="".concat(k.a.pwaUrl,"/")||window.location.pathname==="".concat(k.a.pwaUrl))return Object(C.jsx)(h.a,{to:"".concat(k.a.pwaUrl,"/bookmarks")})}},{key:"render",value:function(){var e,t,n=this;return Object(C.jsxs)(f.b,{children:[Object(C.jsx)(j.a,{children:Object(C.jsxs)(f.y,{children:[Object(C.jsxs)(f.t,{animated:!1,children:[Object(C.jsx)(h.b,{path:"".concat(k.a.pwaUrl,"/:tab(bookmarks)"),render:function(e){return Object(C.jsx)(S.a,Object(i.a)({},e))},exact:!0}),Object(C.jsx)(h.b,{path:"".concat(k.a.pwaUrl,"/:tab(home)"),render:function(e){return Object(C.jsx)(O.a,Object(i.a)({},e))},exact:!0}),Object(C.jsx)(h.b,{path:"".concat(k.a.pwaUrl,"/settings"),render:function(e){return Object(C.jsx)(w.a,Object(i.a)({},e))}}),Object(C.jsx)(h.b,{path:"".concat(k.a.pwaUrl,"/"),render:function(){return n.routeByQueryString()},exact:!0})]}),Object(C.jsxs)(f.w,{slot:"bottom",children:[Object(C.jsx)(f.x,{tab:"bookmarks",href:"".concat(k.a.pwaUrl,"/bookmarks"),children:Object(C.jsx)(f.f,{icon:x.b})}),Object(C.jsx)(f.x,{tab:"home",href:"".concat(k.a.pwaUrl,"/home"),children:Object(C.jsx)(f.f,{icon:x.A})}),Object(C.jsx)(f.x,{tab:"settings",href:"".concat(k.a.pwaUrl,"/settings"),children:Object(C.jsx)(f.f,{icon:x.w})})]})]})}),Object(C.jsx)(f.a,{cssClass:"uiFont",isOpen:this.state.showUpdateAlert,backdropDismiss:!1,onDidPresent:function(e){var t,s,r,o;null===(t=n.registrationNew)||void 0===t||null===(s=t.installing)||void 0===s||s.postMessage({type:"SKIP_WAITING"}),null===(r=n.registrationNew)||void 0===r||null===(o=r.waiting)||void 0===o||o.postMessage({type:"SKIP_WAITING"})},header:"App \u5df2\u66f4\u65b0\uff0c\u8acb\u91cd\u555f!",buttons:[{text:"\u95dc\u9589",cssClass:"primary uiFont",handler:function(e){n.setState({showUpdateAlert:!1})}},{text:"\u986f\u793a\u7248\u672c\u6b77\u53f2",cssClass:"secondary uiFont",handler:function(e){window.open("https://github.com/MrMYHuang/twri#history")}}]}),Object(C.jsx)(y.a,Object(i.a)({},Object(i.a)({text:null===(e=this.props.shareTextModal)||void 0===e?void 0:e.text,showModal:(null===(t=this.props.shareTextModal)||void 0===t?void 0:t.show)||!1,finish:function(){T.dispatch({type:"TMP_SET_KEY_VAL",key:"shareTextModal",val:{show:!1}})}},this.props))),Object(C.jsx)(f.A,{cssClass:"uiFont",isOpen:this.state.showRestoreAppSettingsToast,onDidDismiss:function(){return n.setState({showRestoreAppSettingsToast:!1})},message:"\u5df2\u5957\u7528 app \u9023\u7d50\u4e2d\u7684\u8a2d\u5b9a\uff0c\u662f\u5426\u9084\u539f\u8a2d\u5b9a\uff1f",buttons:[{text:"\u53d6\u6d88",role:"cancel",handler:function(){return n.setState({showRestoreAppSettingsToast:!1})}},{text:"\u9084\u539f",handler:function(){return n.restoreAppSettings()}}]}),Object(C.jsx)(f.A,{cssClass:"uiFont",isOpen:this.state.showToast,onDidDismiss:function(){return n.setState({showToast:!1})},message:this.state.toastMessage,duration:2e3})]})}}]),s}(d.a.Component),R=Object(v.b)((function(e){return{shareTextModal:e.tmpSettings.shareTextModal,settings:e.settings}}))(L),E=Object(h.f)(I);t.a=E}).call(this,n(97).setImmediate)},80:function(e){e.exports=JSON.parse('{"name":"twri","homepage":"/twri","productName":"\u53f0\u7063\u6c34\u5eab","pwaVersion":"1.6.2","version":"1.1.0","license":"MIT","keywords":["\u6c34\u5eab","\u6c34\u91cf"],"description":"\u53f0\u7063\u6c34\u5eab app \u53ef\u67e5\u8a62\u5168\u53f0\u6c34\u5eab\u5132\u6c34\u91cf\u3002","repository":"https://github.com/MrMYHuang/twri","author":{"name":"Meng-Yuan Huang","email":"myh@live.com"},"private":false,"files":["README.md"],"main":"buildElectron/main.js","scripts":{"postinstall":"electron-builder install-app-deps","start":"react-app-rewired start","build":"react-app-rewired build && powershell -file CopyBuild.ps1","build_linux":"react-app-rewired build && ./CopyBuild.sh","test":"react-app-rewired test","eject":"react-scripts eject","build-electron":"tsc -b tsconfigElectron.json","build-electron-store":"tsc -b tsconfigElectron.json && mv buildElectron/mainStore.js buildElectron/main.js","start-electron":"npm run build-electron && electron .","dist-snap":"npm run build-electron-store && rm -f dist/*.snap && electron-builder -l snap -c electronBuilderConfigs/snap.json","dist-snap-arm64":"export SNAPCRAFT_BUILD_ENVIRONMENT=lxd && npm run build-electron-store && rm -f dist/*.snap && electron-builder -l snap --arm64 -c electronBuilderConfigs/snap.json","publish-snap":"snapcraft upload --release=stable dist/*.snap","icons-mas":"cd buildElectron && iconutil -c icns icon.iconset","dist-mas":"npm run build-electron-store && electron-builder -m mas --universal -c electronBuilderConfigs/mas.json","dist-mas-dev":"npm run build-electron-store && electron-builder -m mas-dev --arm64 -c electronBuilderConfigs/masDev.json"},"eslintConfig":{"extends":"react-app"},"dependencies":{"@types/d3":"^7.0.0","@types/semver":"^7.3.7","adm-zip":"^0.5.5","axios":"^0.21.1","d3":"^7.0.0","electron-window-state":"^5.0.3","node-downloader-helper":"^1.0.18","semver":"^7.3.5"},"devDependencies":{"@ionic/react":"^5.6.12","@ionic/react-router":"^5.6.12","@testing-library/jest-dom":"^5.14.1","@testing-library/react":"^11.2.7","@testing-library/user-event":"^12.8.3","@types/adm-zip":"^0.4.34","@types/jest":"^26.0.24","@types/node":"^12.20.16","@types/qrcode":"^1.4.1","@types/react":"^16.14.11","@types/react-dom":"^16.9.14","@types/react-redux":"^7.1.18","@types/react-router":"^5.1.16","@types/react-router-dom":"^5.1.8","@types/uuid":"^8.3.1","customize-cra":"^1.0.0","electron":"^11.4.10","electron-builder":"^22.11.7","electron-builder-notarize-pkg":"^1.2.0","history":"^4.10.1","ionicons":"^5.5.2","memfs":"^3.2.0","qrcode":"^1.4.4","query-string":"^6.14.1","react":"^17.0.2","react-app-rewired":"^2.1.7","react-dom":"^17.0.2","react-redux":"^7.2.4","react-router":"^5.2.0","react-router-dom":"^5.2.0","react-scripts":"^4.0.3","redux":"^4.1.0","swiped-events-myh":"^1.2.0","typescript":"^4.3.5","uuid":"^8.3.1","workbox-background-sync":"^5.1.3","workbox-broadcast-update":"^5.1.3","workbox-cacheable-response":"^5.1.3","workbox-core":"^5.1.3","workbox-expiration":"^5.1.3","workbox-google-analytics":"^5.1.3","workbox-navigation-preload":"^5.1.3","workbox-precaching":"^5.1.3","workbox-range-requests":"^5.1.3","workbox-routing":"^5.1.3","workbox-strategies":"^5.1.3","workbox-streams":"^5.1.3"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')}},[[273,3,4]]]);
//# sourceMappingURL=main.17bbd994.chunk.js.map